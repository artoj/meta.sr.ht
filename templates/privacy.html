{% extends "meta.html" %}
{% block content %}
<div class="row">
  <section class="col-md-8">
    <h3>Encryption</h3>
    <p>
      All emails sent from sr.ht to you are signed with
      <a href="/privacy/pubkey">{{cfg("sr.ht", "pgp-key-id")}}</a>.
    </p>
    {% if any(current_user.pgp_keys) %}
    <form method="POST" action="/privacy">
      <div class="form-check">
        <label class="form-check-label">
          <input
            class="form-check-input"
            type="radio"
            name="pgp-key"
            value="null"
            {%if current_user.pgp_key_id == None%}checked{%endif%}
          /> Do not encrypt emails sent to me
        </label>
      </div>
      {% for key in current_user.pgp_keys %}
      <div class="form-check">
        <label class="form-check-label">
          <input
            class="form-check-input"
            type="radio"
            name="pgp-key"
            value="{{key.id}}"
            {%if current_user.pgp_key_id == key.id%}checked{%endif%}
          /> Encrypt with {{key.email}} {{key.key_id}}
        </label>
      </div>
      {% endfor %}
      <button type="submit" class="pull-right btn btn-default">Save</button>
    </form>
    <form method="POST" action="/privacy/test-email" style="clear: both; padding-top: 0.5rem">
      <button type="submit" class="pull-right btn btn-default">Send test email</button>
    </form>
    {% else %}
    <p>If you <a href="/keys">add a PGP key</a> to your account, we can encrypt
    emails to you.</p>
    {% endif %}
  </section>
</div>
{% endblock %}
